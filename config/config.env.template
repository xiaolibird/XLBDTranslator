# ==========================================
# XLBD Translator - 环境配置文件
# ==========================================
# 配置格式: SECTION__KEY=VALUE
# 修改后需要重启程序才能生效

# ==========================================
# API 配置 (必须配置)
# ==========================================

# Gemini API 密钥
# 说明: 从 Google AI Studio 获取的 API Key
# 获取地址: https://aistudio.google.com/app/apikey
# 取值: 以 "AIzaSy" 开头的字符串
API__GEMINI_API_KEY=your_gemini_api_key_here

# Gemini 模型选择
# 说明: 使用的 Gemini 模型版本
# 可选值:
#   - gemini-2.5-pro (最强，适合复杂学术翻译，成本较高)
#   - gemini-2.5-flash (快速，适合一般翻译，成本低，默认推荐)
#   - gemini-2.0-flash (更快，但质量略低)
# 推荐: gemini-2.5-flash (性价比最高)
API__GEMINI_MODEL=gemini-2.5-pro

# 翻译引擎选择
# 可选值:
#   - gemini: 使用 Google Gemini (默认)
#   - deepseek: 使用 DeepSeek OpenAI-compatible 接口
#   - openai-compatible: 使用 OpenAI-compatible 接口（同 deepseek 逻辑）
API__TRANSLATOR_PROVIDER=gemini

# ==========================================
# DeepSeek / OpenAI-compatible 配置 (可选)
# ==========================================
# 说明: DeepSeek API 格式兼容 OpenAI Chat Completions。
# 文档: https://api-docs.deepseek.com/

# DeepSeek API Key（OpenAI-compatible）
# 推荐变量名: API__OPENAI_API_KEY
# 也兼容: API__DEEPSEEK_API_KEY
API__OPENAI_API_KEY=your_deepseek_api_key_here

# base_url
# DeepSeek: https://api.deepseek.com
# 也可用: https://api.deepseek.com/v1
API__OPENAI_BASE_URL=https://api.deepseek.com

# 模型
# 可选: deepseek-chat / deepseek-reasoner
API__OPENAI_MODEL=deepseek-chat

# ==========================================
# 文件路径配置
# ==========================================

# 待翻译文档的绝对路径
# 说明: 支持 PDF 和 EPUB 格式
# 取值: 完整文件路径 (推荐使用绝对路径)
# 示例: /Users/username/Documents/book.pdf
FILES__DOCUMENT_PATH=/path/to/your/document.pdf

# 输出目录
# 说明: 项目缓存和中间文件的存放位置
# 取值: 相对路径或绝对路径
# 默认: output (在项目根目录下创建)
FILES__OUTPUT_BASE_DIR=output

# 最终翻译文件输出目录 (可选)
# 说明: 翻译完成的 Markdown 和 PDF 存放位置
# 取值: 相对路径或绝对路径
# 默认: 用户的下载文件夹
# FILES__FINAL_OUTPUT_DIR=./final_translations

# 日志文件路径
# 说明: 记录翻译过程的详细日志
# 取值: 相对路径或绝对路径
# 默认: logs/[文档名].log
FILES__LOG_FILE=logs/translation.log

# 翻译模式配置文件路径
# 说明: 定义不同翻译模式的 JSON 配置
# 取值: 相对路径或绝对路径
# 默认: config/modes.json (通常无需修改)
FILES__MODES_CONFIG_PATH=config/modes.json

# ==========================================
# 处理与性能配置
# ==========================================

# 翻译模式
# 说明: 选择预定义的翻译风格和人格
# 可选值:
#   1 = Zizek Expert (齐泽克专家 - 拉康精神分析+黑格尔哲学，批判性技术导师)
#   2 = Biography Journalist (传记记者 - 历史传记翻译，文学性+历史严谨性)
#   3 = Sociology Researcher (社会学研究者 - 批判理论+大陆哲学，学术出版标准)
#   4 = AI Data Scientist (AI数据科学家 - 神经科学+健康科学，信息提取+逻辑归纳)
#   5 = Novel Translator (小说翻译家 - 英日小说翻译，情感细腻+生活细节)
#   6 = Nietzsche-ish Interpretive (尼采式诠释 - 查拉图斯特拉风格，隐喻解构+哲学具象)
#   7 = Lazy Genius Digest (懒人天才摘要 - 跨学科学者，压缩精读+概念注解)
# 默认: 7 (推荐用于快速理解复杂文本)
# PROCESSING__TRANSLATION_MODE=7

# 批次大小
# 说明: 每次发送给 API 的片段数量
# 取值: 1-10
# 推荐:
#   - 1-3: 高质量翻译，速度慢
#   - 5: 平衡模式 (默认推荐)
#   - 8-10: 快速翻译，质量略降
# 影响: 数值越大速度越快，但单次失败损失越大
PROCESSING__BATCH_SIZE=5

# 上下文窗口长度
# 说明: 翻译时参考的前文字符数
# 取值: 512-8192
# 推荐:
#   - 1024: 短篇文章 (默认)
#   - 2048-4096: 中长篇文章
#   - 8192: 学术书籍 (需要更多上下文)
# 影响: 越大翻译连贯性越好，但 API 成本越高
PROCESSING__MAX_CONTEXT_LENGTH=1024

# 最大重试次数
# 说明: API 调用失败后的最大重试次数
# 取值: 1-10
# 默认: 3
# 影响: 网络不稳定时建议增大
PROCESSING__MAX_RETRIES=3

# 请求超时时间 (秒)
# 说明: 单次 API 请求的最长等待时间
# 取值: 30-300
# 默认: 60
# 推荐:
#   - 60: 一般文档
#   - 120: 复杂学术文档
#   - 180: 图表密集的文档
PROCESSING__REQUEST_TIMEOUT=60

# API 调用间隔 (秒)
# 说明: 文本翻译请求之间的等待时间
# 取值: 0.1-5.0
# 默认: 1.0
# 影响: 防止触发速率限制，过小可能被限流
PROCESSING__RATE_LIMIT_DELAY=1.0

# 视觉模式 API 调用间隔 (秒)
# 说明: 图片翻译请求之间的等待时间
# 取值: 1.0-10.0
# 默认: 2.0
# 影响: 视觉 API 限流更严格，建议保持默认
PROCESSING__VISION_RATE_LIMIT_DELAY=2.0

# 最小文本块大小 (字符)
# 说明: 单个翻译片段的最小字符数
# 取值: 100-500
# 默认: 200
# 影响: 过小导致翻译碎片化，过大可能超出 API 限制
PROCESSING__MIN_CHUNK_SIZE=200

# 最大文本块大小 (字符)
# 说明: 单个翻译片段的最大字符数
# 取值: 1000-5000
# 默认: 2000
# 影响: 过大可能导致 JSON 截断
PROCESSING__MAX_CHUNK_SIZE=2000

# 启用文档结构缓存 (structure_map.json)
# 说明: 是否保存文档的章节结构和分段信息到缓存文件
# 功能: 避免重复解析PDF/EPUB，加速重启后的文档加载
# 可选值: True / False
# 默认: True (强烈推荐开启)
# 影响: 关闭后每次启动都需要重新解析整个文档结构 (PDF可能需要几分钟)
# 注意: 此缓存与"断点续传"无关，是文档解析阶段的优化
PROCESSING__ENABLE_CACHE=True

# 使用面包屑导航
# 说明: 在翻译时显示当前章节路径 (如: Chapter 1 > Section 1.1)
# 可选值: True / False
# 默认: False
# 影响: 开启后可能增加 Token 消耗
PROCESSING__USE_BREADCRUMB=False

# 渲染页码标记
# 说明: 在 Markdown 输出中显示页码注释
# 可选值: True / False
# 默认: True
# 影响: 方便定位原文位置
PROCESSING__RENDER_PAGE_MARKERS=True

# 使用视觉模式 (实验性)
# 说明: 对图片使用 Gemini Vision API 进行翻译
# 可选值: True / False
# 默认: False
# 影响: 开启后可翻译图表文字，但成本显著增加
# PROCESSING__USE_VISION_MODE=True

# 保留原文
# 说明: 在翻译结果中保留英文原文
# 可选值: True / False
# 默认: False
# 影响: 开启后输出双语对照格式
PROCESSING__RETAIN_ORIGINAL=False

# ==========================================
# 高级优化配置 (新功能)
# ==========================================

# JSON 自我修正重试次数
# 说明: API 返回格式错误时，让模型自我修正的次数
# 取值: 0-5
# 默认: 2
# 推荐: 2 (98% 成功率，0 则禁用自我修正)
# 影响: 显著提高 JSON 解析成功率
PROCESSING__JSON_REPAIR_RETRIES=2

# 启用异步翻译
# 说明: 使用多线程并发翻译，理论速度提升 4 倍
# 可选值: True / False
# 默认: True (大文档自动启用)
# 影响: 关闭后使用同步模式 (更稳定但慢)
PROCESSING__ENABLE_ASYNC=True

# 异步模式启用阈值
# 说明: 待翻译片段数超过此值时启用异步
# 取值: 5-50
# 默认: 10
# 推荐: 10-20 (小文档用同步，大文档用异步)
PROCESSING__ASYNC_THRESHOLD=10

# 异步最大并发数
# 说明: 异步模式下同时运行的线程数
# 取值: 1-20
# 默认: 10
# 推荐:
#   - 5-8: 网络不稳定时
#   - 10: 平衡模式 (默认)
#   - 15-20: 高速网络 (可能触发限流)
# 影响: 过大可能触发 API 速率限制
PROCESSING__ASYNC_MAX_WORKERS=10

# 启用翻译进度断点续传 (checkpoint.json)
# 说明: 实时保存每个片段的翻译进度和状态
# 功能: 翻译中断 (网络断开/程序崩溃/手动停止) 后，重启可从上次位置继续
# 可选值: True / False
# 默认: True (强烈推荐开启)
# 影响: 关闭后中断即需重头翻译，浪费已消耗的API额度
# 注意: 此功能是"翻译阶段"的进度保存，与文档结构缓存不同
PROCESSING__ENABLE_CHECKPOINT=True

# 检查点保存间隔
# 说明: 每隔多少个批次保存一次进度
# 取值: 1-10
# 默认: 1 (每批都保存，最安全)
# 推荐: 1-2
# 影响: 越大保存次数越少，但中断损失越大
PROCESSING__CHECKPOINT_INTERVAL=1

# 启用 Gemini Context Caching
# 说明: 缓存系统指令和术语表，节省 60% 成本
# 可选值: True / False
# 默认: True (强烈推荐开启)
# 影响: 关闭后每次请求都发送完整指令 (成本高)
PROCESSING__ENABLE_GEMINI_CACHING=True

# Gemini 缓存有效期 (小时)
# 说明: 缓存内容的保存时长
# 取值: 1-24
# 默认: 1
# 推荐: 1-2 (Gemini 免费缓存上限 1 小时)
# 影响: 超时后需重新创建缓存
PROCESSING__CACHE_TTL_HOURS=1

# 使用 Rich 美化进度条
# 说明: 显示彩色动态进度条 (需要安装 rich 库)
# 可选值: True / False
# 默认: True (未安装 rich 时自动回退 tqdm)
# 影响: 更好看的界面，无功能差异
PROCESSING__USE_RICH_PROGRESS=True

# ==========================================
# 日志配置
# ==========================================

# 日志级别
# 说明: 控制日志详细程度
# 可选值:
#   - DEBUG: 最详细 (调试时使用)
#   - INFO: 一般信息 (默认推荐)
#   - WARNING: 仅警告和错误
#   - ERROR: 仅错误
# 默认: INFO
LOGGING__LOG_LEVEL=INFO

# ==========================================
# 文档特定配置 (PDF 裁切边距)
# ==========================================

# 上边距裁切比例
# 说明: 裁掉 PDF 页面顶部的页眉/页码
# 取值: 0.0-0.3 (0 = 不裁切, 0.3 = 裁掉 30%)
# 默认: 0.10 (裁掉 10%)
DOCUMENT__MARGIN_TOP=0.10

# 下边距裁切比例
# 说明: 裁掉 PDF 页面底部的页脚/页码
# 取值: 0.0-0.3
# 默认: 0.08
DOCUMENT__MARGIN_BOTTOM=0.08

# 左边距裁切比例
# 说明: 裁掉 PDF 页面左侧空白
# 取值: 0.0-0.2
# 默认: 0.05
DOCUMENT__MARGIN_LEFT=0.05

# 右边距裁切比例
# 说明: 裁掉 PDF 页面右侧空白
# 取值: 0.0-0.2
# 默认: 0.05
DOCUMENT__MARGIN_RIGHT=0.05

# 页码范围 (可选)
# 说明: 只翻译指定页码范围
# 格式:
#   - JSON 数组: "[10, 50]" (第 10-50 页)
#   - 逗号分隔: "1,30" (第 1 页和第 30 页)
# 默认: 不设置 (翻译全部页面)
# DOCUMENT__PAGE_RANGE="[10, 50]"
# DOCUMENT__PAGE_RANGE="1,30"

# 自定义目录文件路径 (可选)
# 说明: 使用外部 CSV 文件定义章节结构
# 取值: CSV 文件路径
# 格式: page,chapter_title
# 示例: 1,Introduction
# 默认: 不设置 (自动检测章节)
# DOCUMENT__CUSTOM_TOC_PATH=./test/test_toc.csv